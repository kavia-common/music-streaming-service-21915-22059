{"is_source_file": true, "format": "Python", "description": "Source code for a FastAPI-based 'Observability API' that handles log and metric ingestion, querying, alert management, and compliance reporting. Contains API endpoints, data models, and in-memory persistence logic.", "external_files": ["fastapi", "pydantic", "threading", "time", "datetime", "os", "json"], "external_methods": ["fastapi.FastAPI", "fastapi.Depends", "fastapi.Header", "fastapi.HTTPException", "fastapi.Query", "fastapi.Request", "fastapi.Response", "fastapi.status", "fastapi.middleware.cors.CORSMiddleware", "pydantic.BaseModel", "pydantic.Field", "datetime.datetime", "os.getenv", "os.path.join", "os.makedirs", "json.load", "json.dump", "json.dumps", "threading.Thread", "threading.Lock", "time"], "published": ["app", "health_check", "ingest_logs", "ingest_metrics", "query_logs", "query_metrics", "get_alerts", "upsert_alert", "get_compliance_reports"], "classes": [{"name": "LogIngest", "description": "Pydantic model for log ingestion payload, includes source, timestamp, level, message, and optional metadata."}, {"name": "MetricIngest", "description": "Pydantic model for metrics ingestion, includes source, timestamp, and metrics dictionary."}, {"name": "AlertRule", "description": "Pydantic model to define alert rules with name, expression, severity, and optional notification channels."}, {"name": "AlertOut", "description": "Extended alert model showing last trigger time and active status."}], "methods": [{"name": "_load_api_keys_from_env", "description": "Loads and parses API keys from environment variable 'OBS_API_KEYS'."}, {"name": "_load_json_file", "description": "Safely loads a JSON file or returns default if not present or on error."}, {"name": "_save_json_file", "description": "Saves data to a JSON file atomically."}, {"name": "_bootstrap_store", "description": "Initializes in-memory data stores from persisted files."}, {"name": "_persist_async", "description": "Persists in-memory data stores asynchronously in background."}, {"name": "health_check", "description": "Health check endpoint indicating service liveness."}, {"name": "ingest_logs", "description": "Endpoint to ingest a log entry and store it."}, {"name": "ingest_metrics", "description": "Endpoint to ingest metrics data."}, {"name": "query_logs", "description": "Endpoint to query logs with filtering and pagination."}, {"name": "query_metrics", "description": "Endpoint to query metrics with filtering and pagination."}, {"name": "get_alerts", "description": "Returns current alert rules and their status."}, {"name": "upsert_alert", "description": "Create or update an alert rule."}, {"name": "get_compliance_reports", "description": "Provides a summary report of ingested logs, metrics, and alerts."}], "calls": ["os.getenv", "os.makedirs", "os.path.join", "json.load", "json.dump", "threading.Thread", "threading.Lock", "datetime.fromisoformat", "datetime.utcnow", "app.add_middleware", "app.get", "app.post", "Depends", "HTTPException"], "search-terms": ["Observability API", "log ingestion", "metrics ingestion", "alert rules", "query logs", "query metrics", "health check", "fastapi", "pydantic", "in-memory persistence", "JSON file storage", "environment variable API keys", "CORS middleware"], "state": 2, "file_id": 5, "knowledge_revision": 11, "git_revision": "", "ctags": [], "hash": "d46c7fbf506b930dfd1d3bf56d9ad589", "format-version": 4, "code-base-name": "Monitoring&Logging", "filename": "Monitoring&Logging/music-streaming-service-21915-22059/MonitoringLogging/src/api/main.py", "revision_history": [{"11": ""}]}