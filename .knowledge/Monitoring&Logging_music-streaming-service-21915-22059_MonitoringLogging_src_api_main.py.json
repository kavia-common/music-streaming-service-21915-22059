{"is_source_file": true, "format": "Python", "description": "This file defines a FastAPI-based web API for monitoring, logging, metrics ingestion, alert management, and compliance reporting in a music streaming service. It includes endpoints for health checks, log and metric ingestion, querying, alert rule management, and reports. The code manages in-memory data stores with optional persistence to JSON files, and handles authentication via API keys.", "external_files": ["fastapi", "pydantic", "threading", "datetime", "os", "json"], "external_methods": ["Depends", "FastAPI", "Header", "HTTPException", "Query", "status", "CORSMiddleware", "BaseModel", "Field"], "published": ["health_check", "ingest_logs", "ingest_metrics", "query_logs", "query_metrics", "get_alerts", "upsert_alert", "get_compliance_reports"], "classes": [{"name": "LogIngest", "description": "Data model for ingesting log entries, including source, timestamp, level, message, and optional metadata."}, {"name": "MetricIngest", "description": "Data model for ingesting metric data, including source, timestamp, and metrics dictionary."}, {"name": "AlertRule", "description": "Model representing an alert rule with a name, expression, severity, and optional notification channels."}], "methods": [{"name": "_load_json_file", "description": "Utility to load data from a JSON file with default fallback."}, {"name": "_save_json_file", "description": "Utility to save data to a JSON file atomically."}, {"name": "_bootstrap_store", "description": "Initializes in-memory store from persisted JSON files."}, {"name": "_persist_async", "description": "Triggers asynchronous persistence of in-memory data to JSON files."}, {"name": "auth_bearer_dependency", "description": "Dependency function that authenticates requests using Bearer tokens based on API keys."}, {"name": "health_check", "description": "Endpoint for health status check of the service."}, {"name": "ingest_logs", "description": "Endpoint to ingest logs into the system."}, {"name": "ingest_metrics", "description": "Endpoint to ingest metrics into the system."}, {"name": "query_logs", "description": "Endpoint to query logs with filtering and pagination."}, {"name": "query_metrics", "description": "Endpoint to query metrics with filtering and pagination."}, {"name": "get_alerts", "description": "Retrieves current alert rules and statuses."}, {"name": "upsert_alert", "description": "Creates or updates an alert rule."}, {"name": "get_compliance_reports", "description": "Generates a compliance report with summaries of logs, metrics, and alerts."}], "calls": ["json.load", "json.dump", "os.path.exists", "os.remove", "threading.Thread", "datetime.fromisoformat", "datetime.utcnow", "os.getenv", "os.makedirs", "os.replace"], "search-terms": ["MonitoringLogging", "FastAPI", "LogIngest", "MetricIngest", "AlertRule", "API endpoints", "JSON persistence", "auth_bearer_dependency", "log query", "metrics query", "alert management", "compliance report"], "state": 2, "file_id": 5, "knowledge_revision": 14, "git_revision": "ee642739d8e52ebede6bade82cd99b775234de49", "revision_history": [{"11": ""}, {"14": "ee642739d8e52ebede6bade82cd99b775234de49"}], "ctags": [], "hash": "03ef13851839e342395ef42fbb8453a7", "format-version": 4, "code-base-name": "Monitoring&Logging", "filename": "Monitoring&Logging/music-streaming-service-21915-22059/MonitoringLogging/src/api/main.py"}